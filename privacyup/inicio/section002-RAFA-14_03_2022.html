<div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 col-sm-10 offset-sm-1 col-md-10 offset-md-1 col-lg-10 offset-lg-1 col-xl-10 offset-xl-1">
            <h1>Será que sua empresa precisa se adaptar a LGPD?</h1>
            <p>Responda nosso quiz para descobrir.</p>
            <a href="#" class="btn btn-tertiary shadow-none" data-bs-toggle="modal" data-bs-target="#quizStart">
                <i class="bi bi-quora"></i> Quiz
            </a>
        </div>
    </div>
</div>
<div class="modal fade" tabindex="-1" aria-hidden="true" aria-labelledby="quizStart" id="quizStart">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-square"></i> Close
                </button>
                <div class="row">
                    <div
                        class="col-xs-12 col-sm-10 offset-sm-1 col-md-10 offset-md-1 col-lg-10 offset-lg-1 col-xl-10 offset-xl-1 grid-top">
                        <h1>Quiz - do RAFA</h1>
                        <p>Texto de introdução ao quiz!</p>
                    </div>
                    <div
                        class="col-xs-12 col-sm-10 offset-sm-1 col-md-10 offset-md-1 col-lg-10 offset-lg-1 col-xl-10 offset-xl-1 grid-middle">
                        <div class="card" style="display: block;">
                            <button class="btn btn-primary shadow-none next" onclick="next(1)">
                                <i class="bi bi-arrow-down-circle"></i> Começar!
                            </button>
                        </div>
                        <div class="card">
                            Q1 Question 1?
                            <hr>
                            <input type="radio" name="question1" value="Sim" id="correct1" onclick="next(2)">SIM<br><br>
                            <input type="radio" name="question1" value="Não" onclick="next(2)">Não<br>
                        </div>

                        <div class="card">
                            Q2 Question 2?
                            <hr>
                            <input type="radio" name="question2" value="Sim" id="correct2" onclick="next(3)">SIM<br><br>
                            <input type="radio" name="question2" value="Não" onclick="next(3)">Não<br>
                            <button class="btn btn-primary shadow-none next" onclick="prev(1)">Voltar</button>
                        </div>

                        <div class="card">
                            Q3 Question 3?
                            <hr>
                            <input type="radio" name="question3" value="Sim" id="correct3" onclick="next(4)">SIM<br><br>
                            <input type="radio" name="question3" value="Não" onclick="next(4)">Não<br>
                            <button class="btn btn-primary shadow-none next" onclick="prev(2)">Voltar</button>
                        </div>

                        <div class="card">
                            Resultado
                            <hr><br>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" name="userName" placeholder="*Seu Nome"
                                    required="" oninvalid="this.setCustomValidity('Por favor inserir seu nome')"
                                    oninput="setCustomValidity('')" spellcheck="false" data-ms-editor="true">
                                <label for="floatingInput">*Seu Nome</label>
                            </div>

                            <div class="row">
                                <div class="col-md">
                                    <div class="form-floating mb-3">
                                        <input type="email" class="form-control" name="userEmail"
                                            placeholder="*Seu email" required=""
                                            oninvalid="this.setCustomValidity('Por favor inserir seu e-mail')"
                                            oninput="setCustomValidity('')">
                                        <label for="floatingInput">*Seu email</label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" name="userPhone"
                                            placeholder="*Número para contato" required=""
                                            oninvalid="this.setCustomValidity('Por favor inserir seu número para contato')"
                                            oninput="setCustomValidity('')" spellcheck="false" data-ms-editor="true">
                                        <label for="floatingPassword">*Número para contato</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" name="userCompanySector"
                                    placeholder="*Setor da sua empresa" required=""
                                    oninvalid="this.setCustomValidity('Por favor inserir o setor da sua empresa')"
                                    oninput="setCustomValidity('')">
                                <label for="floatingInput">*Setor da sua empresa</label>
                            </div>

                            <div class="form-floating mb-3">
                                <input type="number" class="form-control" name="usersNumbersEmployees"
                                    placeholder="*Número de funcionários" required=""
                                    oninvalid="this.setCustomValidity('Por favor inserir o número de funcionários')"
                                    oninput="setCustomValidity('')" spellcheck="false" data-ms-editor="true">
                                <label for="floatingPassword">*Número de funcionários</label>
                            </div>

                            <div class="form-floating mb-3">
                                <textarea class="form-control" name="userMessage" placeholder="Deixe sua mensagem aqui."
                                    style="height:150px" required=""
                                    oninvalid="this.setCustomValidity('Digite sua mensagem')"
                                    oninput="setCustomValidity('')" spellcheck="false" data-ms-editor="true"></textarea>
                                <label for="floatingTextarea">Deixe sua mensagem aqui.</label>
                            </div>

                            <button class="btn btn-primary shadow-none next" onclick="prev(3)">Voltar</button>
                            <button class="btn btn-primary shadow-none next" onclick="result()">
                                <i class="bi bi-arrow-down-circle"></i> Resultado!
                            </button>
                        </div>
                        <script>
                            // displaying the first block of question
                            document.getElementsByClassName('card')[0].style.display = "block";

                            // DEFINING THE NEXT FUNCTION
                            function next(id) {
                                document.getElementsByClassName('card')[id - 1].style.display = "none";
                                document.getElementsByClassName('card')[id].style.display = "block";
                            }

                            function prev(id) {
                                console.log(id)
                                document.getElementsByClassName('card')[id + 1].style.display = "none";
                                document.getElementsByClassName('card')[id].style.display = "block";
                            }

                            //getting final result
                            function result() {
                                var score = 0;
                                if (document.getElementById('correct1').checked) {
                                    score++;
                                }
                                if (document.getElementById('correct2').checked) {
                                    score++;
                                }
                                if (document.getElementById('correct3').checked) {
                                    score++;
                                }

                                var url = "../api/sendQuizMail.php"
                                var data = {
                                    userName: document.getElementsByName('userName')[0].value,
                                    userEmail: document.getElementsByName('userEmail')[0].value,
                                    userPhone: document.getElementsByName('userPhone')[0].value,
                                    userCompanySector: document.getElementsByName('userCompanySector')[0].value,
                                    usersNumbersEmployees: document.getElementsByName('usersNumbersEmployees')[0].value,
                                    userMessage: document.getElementsByName('userMessage')[0].value,
                                    question1: document.getElementsByName('question1')[0].value,
                                    question2: document.getElementsByName('question2')[0].value,
                                    question3: document.getElementsByName('question3')[0].value,
                                    score: score
                                }

                                var form = new FormData()
                                for (var i in data) {
                                    form.set(i, data[i])
                                }

                                let opt = {
                                    method: 'post',
                                    headers: new Headers(),
                                    mode: 'cors',
                                    cache: 'default',
                                    body: form
                                }

                                // Sending ...
                                fetch(url, opt).then(r => r.json()).then(d => {
                                    alert(d.message)
                                    location.reload()
                                })
                            }
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>